"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5319],{3905:(e,i,n)=>{n.r(i),n.d(i,{MDXContext:()=>d,MDXProvider:()=>u,mdx:()=>h,useMDXComponents:()=>p,withMDXComponents:()=>l});var t=n(67294);function r(e,i,n){return i in e?Object.defineProperty(e,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[i]=n,e}function o(){return o=Object.assign||function(e){for(var i=1;i<arguments.length;i++){var n=arguments[i];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},o.apply(this,arguments)}function s(e,i){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);i&&(t=t.filter((function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable}))),n.push.apply(n,t)}return n}function a(e){for(var i=1;i<arguments.length;i++){var n=null!=arguments[i]?arguments[i]:{};i%2?s(Object(n),!0).forEach((function(i){r(e,i,n[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))}))}return e}function c(e,i){if(null==e)return{};var n,t,r=function(e,i){if(null==e)return{};var n,t,r={},o=Object.keys(e);for(t=0;t<o.length;t++)n=o[t],i.indexOf(n)>=0||(r[n]=e[n]);return r}(e,i);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)n=o[t],i.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var d=t.createContext({}),l=function(e){return function(i){var n=p(i.components);return t.createElement(e,o({},i,{components:n}))}},p=function(e){var i=t.useContext(d),n=i;return e&&(n="function"==typeof e?e(i):a(a({},i),e)),n},u=function(e){var i=p(e.components);return t.createElement(d.Provider,{value:i},e.children)},f={inlineCode:"code",wrapper:function(e){var i=e.children;return t.createElement(t.Fragment,{},i)}},m=t.forwardRef((function(e,i){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,d=c(e,["components","mdxType","originalType","parentName"]),l=p(n),u=r,m=l["".concat(s,".").concat(u)]||l[u]||f[u]||o;return n?t.createElement(m,a(a({ref:i},d),{},{components:n})):t.createElement(m,a({ref:i},d))}));function h(e,i){var n=arguments,r=i&&i.mdxType;if("string"==typeof e||r){var o=n.length,s=new Array(o);s[0]=m;var a={};for(var c in i)hasOwnProperty.call(i,c)&&(a[c]=i[c]);a.originalType=e,a.mdxType="string"==typeof e?e:r,s[1]=a;for(var d=2;d<o;d++)s[d]=n[d];return t.createElement.apply(null,s)}return t.createElement.apply(null,n)}m.displayName="MDXCreateElement"},13812:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>l,contentTitle:()=>c,default:()=>f,frontMatter:()=>a,metadata:()=>d,toc:()=>p});var t=n(83117),r=n(80102),o=(n(67294),n(3905)),s=(n(44996),["components"]),a={id:"device-identifiers",title:"Device Identifiers",sidebar_label:"Device Identifiers"},c=void 0,d={unversionedId:"internals/device-identifiers",id:"internals/device-identifiers",title:"Device Identifiers",description:"Flipper is capable of discovering and listing available devices for multiple platforms. It enables users to check for connected devices and quickly access a number of plugins:",source:"@site/../docs/internals/device-identifiers.mdx",sourceDirName:"internals",slug:"/internals/device-identifiers",permalink:"/docs/internals/device-identifiers",draft:!1,editUrl:"https://github.com/facebook/flipper/blob/main/website/../docs/internals/device-identifiers.mdx",tags:[],version:"current",frontMatter:{id:"device-identifiers",title:"Device Identifiers",sidebar_label:"Device Identifiers"},sidebar:"main",previous:{title:"Contributing to the Codebase",permalink:"/docs/internals/contributing"},next:{title:"Linters",permalink:"/docs/internals/linters"}},l={},p=[{value:"How does Flipper map connecting apps to their respective devices?",id:"how-does-flipper-map-connecting-apps-to-their-respective-devices",level:2},{value:"Obtaining the device identifier",id:"obtaining-the-device-identifier",level:3}],u={toc:p};function f(e){var i=e.components,a=(0,r.Z)(e,s);return(0,o.mdx)("wrapper",(0,t.Z)({},u,a,{components:i,mdxType:"MDXLayout"}),(0,o.mdx)("p",null,"Flipper is capable of discovering and listing available devices for multiple platforms. It enables users to check for connected devices and quickly access a number of plugins:"),(0,o.mdx)("ul",null,(0,o.mdx)("li",{parentName:"ul"},"Logs"),(0,o.mdx)("li",{parentName:"ul"},"Mobile Builds"),(0,o.mdx)("li",{parentName:"ul"},"Crash Reporter")),(0,o.mdx)("p",null,"Device information, including identifiers, is obtained using either ",(0,o.mdx)("inlineCode",{parentName:"p"},"idb list-targets --json")," on iOS or ",(0,o.mdx)("inlineCode",{parentName:"p"},"adb devices")," on Android."),(0,o.mdx)("p",null,"On Flipper Desktop, apps are shown alongside the device it's running on."),(0,o.mdx)("p",null,"Unfortunately, on the client side, obtaining the device identifier is a problem."),(0,o.mdx)("h2",{id:"how-does-flipper-map-connecting-apps-to-their-respective-devices"},"How does Flipper map connecting apps to their respective devices?"),(0,o.mdx)("p",null,"Over the years, for security reasons, both Apple and Google have locked down their APIs so that apps can't find any value that could be considered unique such as a MAC address or serial numbers. This means there's no OS API available."),(0,o.mdx)("p",null,"To obtain this device identifier, a two-way approached had to be used."),(0,o.mdx)("h3",{id:"obtaining-the-device-identifier"},"Obtaining the device identifier"),(0,o.mdx)("p",null,"From the Flipper Desktop side, connected devices are discovered and listed using idb or adb as mentioned above, by which it sees some TCP connections coming in from apps.\nIt is during the certificate exchange process that we do the mapping from apps to device."),(0,o.mdx)("p",null,"In this process, an app creates and sends a Certificate Signing Request (CSR) to Flipper Desktop alongside some other data including the path in the application sandbox where this CSR was originally written."),(0,o.mdx)("p",null,"When Flipper Desktop is processing the request, it effectively lists all possible connected devices and proceeds to try and pull the CSR from each device. The CSR is then compared with the one sent by the client. If there's a match, we have successfully made the pairing and the device identifier is sent back to the client."),(0,o.mdx)("p",null,"The client receives the device identifier and uses this information for subsequent secure TCP connections."),(0,o.mdx)("p",null,"When a secure TCP connection is established, the device identifier is passed along and thus Flipper is able to map the connecting app to its running device."),(0,o.mdx)("p",null,"The following diagram depicts this process."),(0,o.mdx)("p",null,(0,o.mdx)("img",{alt:"Device Identifier Sequence",src:n(96422).Z,width:"1675",height:"1044"})))}f.isMDXComponent=!0},96422:(e,i,n)=>{n.d(i,{Z:()=>t});const t=n.p+"assets/images/sequence_device_id-a35e8f147d8a1b127458815d08e41e3e.png"}}]);
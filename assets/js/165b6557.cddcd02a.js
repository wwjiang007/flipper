"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7233],{3905:(e,n,t)=>{t.r(n),t.d(n,{MDXContext:()=>d,MDXProvider:()=>c,mdx:()=>f,useMDXComponents:()=>m,withMDXComponents:()=>s});var i=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(){return r=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},r.apply(this,arguments)}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n){if(null==e)return{};var t,i,a=function(e,n){if(null==e)return{};var t,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var d=i.createContext({}),s=function(e){return function(n){var t=m(n.components);return i.createElement(e,r({},n,{components:t}))}},m=function(e){var n=i.useContext(d),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},c=function(e){var n=m(e.components);return i.createElement(d.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},h=i.forwardRef((function(e,n){var t=e.components,a=e.mdxType,r=e.originalType,o=e.parentName,d=p(e,["components","mdxType","originalType","parentName"]),s=m(t),c=a,h=s["".concat(o,".").concat(c)]||s[c]||u[c]||r;return t?i.createElement(h,l(l({ref:n},d),{},{components:t})):i.createElement(h,l({ref:n},d))}));function f(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var r=t.length,o=new Array(r);o[0]=h;var l={};for(var p in n)hasOwnProperty.call(n,p)&&(l[p]=n[p]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var d=2;d<r;d++)o[d]=t[d];return i.createElement.apply(null,o)}return i.createElement.apply(null,t)}h.displayName="MDXCreateElement"},37957:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>g,frontMatter:()=>d,metadata:()=>m,toc:()=>u});var i,a=t(83117),r=t(80102),o=(t(67294),t(3905)),l=t(44996),p=["components"],d={id:"ios",title:"Building an iOS Plugin"},s=void 0,m={unversionedId:"tutorial/ios",id:"tutorial/ios",title:"Building an iOS Plugin",description:"For the purpose of the tutorial, it's assumed you already have an existing iOS application in which you have a feed or list of items.",source:"@site/../docs/tutorial/ios.mdx",sourceDirName:"tutorial",slug:"/tutorial/ios",permalink:"/docs/tutorial/ios",draft:!1,editUrl:"https://github.com/facebook/flipper/blob/main/website/../docs/tutorial/ios.mdx",tags:[],version:"current",frontMatter:{id:"ios",title:"Building an iOS Plugin"},sidebar:"main",previous:{title:"Introduction",permalink:"/docs/tutorial/intro"},next:{title:"Building an Android Plugin",permalink:"/docs/tutorial/android"}},c={},u=[{value:"Creating a plugin",id:"creating-a-plugin",level:2},{value:"Registering your plugin",id:"registering-your-plugin",level:2},{value:"What next?",id:"what-next",level:2}],h=(i="FbInternalOnly",function(e){return console.warn("Component "+i+" was not imported, exported, or provided by MDXProvider as global scope"),(0,o.mdx)("div",e)}),f={toc:u};function g(e){var n=e.components,t=(0,r.Z)(e,p);return(0,o.mdx)("wrapper",(0,a.Z)({},f,t,{components:n,mdxType:"MDXLayout"}),(0,o.mdx)("img",{alt:"iOS Tutorial App",src:(0,l.default)("img/ios-tutorial-app.png")}),(0,o.mdx)("p",null,"For the purpose of the tutorial, it's assumed you already have an existing iOS application in which you have a feed or list of items."),(0,o.mdx)("p",null,"Part of what makes Flipper so useful is allowing users to inspect the internals of their app. This part of the tutorial is concerned with how to make data available to the Flipper desktop app, which, for the sake of this tutorial, is called 'Sea-mammals' (an app based on sea mammals)."),(0,o.mdx)("admonition",{type:"note"},(0,o.mdx)("p",{parentName:"admonition"},"You can find the source code for this tutorial on ",(0,o.mdx)("a",{parentName:"p",href:"https://github.com/facebook/flipper/tree/c55bebd1be545c63dde93e143dd5c341dc2fd20b/iOS/Tutorial/Tutorial"},"GitHub"),".")),(0,o.mdx)("h2",{id:"creating-a-plugin"},"Creating a plugin"),(0,o.mdx)(h,{mdxType:"FbInternalOnly"},(0,o.mdx)("div",{class:"warning"},"[FB-Only] Depending on the options selected during scaffolding (see the [introduction](/docs/tutorial/intro) page), some of the following code might already have been generated by `scarf`.")),(0,o.mdx)("p",null,"On iOS, a Flipper plugin is a class that implements the ",(0,o.mdx)("a",{parentName:"p",href:"https://github.com/facebook/flipper/blob/main/iOS/FlipperKit/FlipperPlugin.h"},"FlipperPlugin")," interface."),(0,o.mdx)("p",null,"The interface consists of four methods:"),(0,o.mdx)("ul",null,(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("inlineCode",{parentName:"li"},"(NSString *)identifier")," - specify a unique string so the JavaScript side knows where to talk to. This must match the name attribute in the ",(0,o.mdx)("inlineCode",{parentName:"li"},"package.json"),", which is examined later in the tutorial."),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("inlineCode",{parentName:"li"},"(void)didConnect:(id<FlipperConnection>)connection")," - this method is called when the desktop client connects and is ready to receive or send data."),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("inlineCode",{parentName:"li"},"(void)didDisconnect")," - sets connection to nil."),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("inlineCode",{parentName:"li"},"(BOOL)runInBackground")," - unless this is true, only the currently selected plugin in the Flipper UI can communicate with the device. Its an optional method which you can override. The default value used is ",(0,o.mdx)("inlineCode",{parentName:"li"},"false"),".")),(0,o.mdx)("p",null,"The following code shows the implementation of these methods for the Sea-mammals app:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-swift"},'import Foundation\nimport FlipperKit\n\nclass SeaMammalsPlugin: NSObject, FlipperPlugin {\n  var connection: FlipperConnection? = nil\n  let mammals: [MarineMammal]\n\n  init(_ marineMammals: [MarineMammal]) {\n      mammals = marineMammals\n  }\n\n  func identifier() -> String! {\n    return "Sea-mammals"\n  }\n\n  func didConnect(_ connection: FlipperConnection!) {\n    self.connection = connection\n    for (index, mammal) in mammals.enumerated() {\n      connection.send("newRow", withParams: ["id": index, "title": mammal.name, "url": mammal.image.absoluteString])\n    }\n  }\n\n  func didDisconnect() {\n    connection = nil;\n  }\n}\n')),(0,o.mdx)("p",null,"There are two items of interest here: ",(0,o.mdx)("inlineCode",{parentName:"p"},"didConnect")," and ",(0,o.mdx)("inlineCode",{parentName:"p"},"connection.send"),", which sends a message to the desktop app and is identified with the name ",(0,o.mdx)("inlineCode",{parentName:"p"},"newRow"),"."),(0,o.mdx)("p",null,"For the Sea-mammals app, there is a static data source. However, in real life, you'll likely dynamically receive new data as the user interacts with the app. So, while in the Sea-mammals app, the data is sent all at once with ",(0,o.mdx)("inlineCode",{parentName:"p"},"didConnect"),", in real life, you'd set up a listener to call ",(0,o.mdx)("inlineCode",{parentName:"p"},'connection.send("newRow", params)')," as the dynamic data arrives."),(0,o.mdx)("admonition",{type:"note"},(0,o.mdx)("p",{parentName:"admonition"},"In the above code, the ",(0,o.mdx)("inlineCode",{parentName:"p"},"withParams")," are just dictionary that contains the data that Sea-mammals sends over the wire to the desktop app.")),(0,o.mdx)("h2",{id:"registering-your-plugin"},"Registering your plugin"),(0,o.mdx)("p",null,"Now all you need to do is let Flipper know about your new plugin. You do this by calling ",(0,o.mdx)("inlineCode",{parentName:"p"},"add")," on your ",(0,o.mdx)("inlineCode",{parentName:"p"},"FlipperClient"),", which is normally created at application startup:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-swift"},"let client = FlipperClient.shared()\n// Add all sorts of other amazing plugins here ...\nclient?.add(SeaMammalsPlugin(MarineMammal.defaultList))\nclient?.start()\n")),(0,o.mdx)("h2",{id:"what-next"},"What next?"),(0,o.mdx)("p",null,"When starting your application, Flipper tells the desktop application about the plugin it supports (including 'Sea-mammals') and looks for a corresponding ",(0,o.mdx)("a",{parentName:"p",href:"/docs/tutorial/javascript"},"JavaScript plugin")," by the same name."))}g.isMDXComponent=!0}}]);